{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 114, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/arthu/OneDrive/Desktop/blackF/combo-3em1-atb/src/lib/supabaseClient.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\r\n\r\n// As vari√°veis de ambiente devem ser configuradas no seu ambiente (ex: .env.local ou Vercel)\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\r\n\r\nif (!supabaseUrl || !supabaseAnonKey) {\r\n  throw new Error('Supabase URL ou Anon Key n√£o foram definidas nas vari√°veis de ambiente.');\r\n}\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\r\n"],"names":[],"mappings":";;;AAAA;;AAEA,6FAA6F;AAC7F,MAAM;AACN,MAAM;AAEN;;AAIO,MAAM,WAAW,CAAA,GAAA,yLAAA,CAAA,eAAY,AAAD,EAAE,aAAa","debugId":null}},
    {"offset": {"line": 129, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/arthu/OneDrive/Desktop/blackF/combo-3em1-atb/src/app/api/validar-acesso/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport { supabase } from \"@/lib/supabaseClient\";\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const { email } = await request.json();\r\n\r\n    if (!email) {\r\n      return NextResponse.json(\r\n        { error: \"Email √© obrigat√≥rio\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const emailLower = email.toLowerCase().trim();\r\n\r\n    // ‚úÖ CORRE√á√ÉO: usar 'customer_email' em vez de 'email'\r\n    const { data, error } = await supabase\r\n      .from(\"compras\")\r\n      .select(\"*\")\r\n      .eq(\"customer_email\", emailLower)\r\n      .eq(\"aprovado\", true)  // Garante que apenas compras aprovadas tem acesso\r\n      .single();\r\n\r\n    if (error && error.code !== \"PGRST116\") {\r\n      // PGRST116 = \"n√£o encontrado\" (esperado se o email n√£o existe)\r\n      console.error(\"‚ùå Erro ao consultar Supabase:\", error);\r\n      return NextResponse.json(\r\n        { error: \"Erro ao validar acesso\" },\r\n        { status: 500 }\r\n      );\r\n    }\r\n\r\n    // Se chegou aqui sem erro e data n√£o √© null = acesso liberado\r\n    const acesso = !!data;\r\n\r\n    console.log(`üìç Valida√ß√£o para ${emailLower}:`, acesso ? \"‚úÖ Acesso liberado\" : \"‚ùå Sem acesso\");\r\n\r\n    return NextResponse.json({\r\n      acesso,\r\n      usuario: data ? {\r\n        email: data.customer_email,\r\n        nome: data.customer_name,\r\n        order_id: data.order_id,\r\n      } : null,\r\n    });\r\n\r\n  } catch (error) {\r\n    console.error(\"‚ùå Erro ao validar acesso:\", error);\r\n    return NextResponse.json(\r\n      { error: \"Erro interno ao validar\" },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}"],"names":[],"mappings":";;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEpC,IAAI,CAAC,OAAO;YACV,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAsB,GAC/B;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,aAAa,MAAM,WAAW,GAAG,IAAI;QAE3C,sDAAsD;QACtD,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,8HAAA,CAAA,WAAQ,CACnC,IAAI,CAAC,WACL,MAAM,CAAC,KACP,EAAE,CAAC,kBAAkB,YACrB,EAAE,CAAC,YAAY,MAAO,kDAAkD;SACxE,MAAM;QAET,IAAI,SAAS,MAAM,IAAI,KAAK,YAAY;YACtC,+DAA+D;YAC/D,QAAQ,KAAK,CAAC,iCAAiC;YAC/C,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAyB,GAClC;gBAAE,QAAQ;YAAI;QAElB;QAEA,8DAA8D;QAC9D,MAAM,SAAS,CAAC,CAAC;QAEjB,QAAQ,GAAG,CAAC,CAAC,kBAAkB,EAAE,WAAW,CAAC,CAAC,EAAE,SAAS,sBAAsB;QAE/E,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB;YACA,SAAS,OAAO;gBACd,OAAO,KAAK,cAAc;gBAC1B,MAAM,KAAK,aAAa;gBACxB,UAAU,KAAK,QAAQ;YACzB,IAAI;QACN;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA0B,GACnC;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}